var debugging=false;if(typeof console=="undefined"||typeof console.log=="undefined"){var console={log:function(){}}}else{if(!debugging&&typeof console!="undefined"){console.log=function(){}}}jQuery(document).ready(function(e){e.ajaxSetup({timeout:20000});function n(){var s=null;e("span.coverImage").not(".combined-results span.coverImage").each(function(u,w){var v=e(w);var t=v.attr("title");e.get("/catalog/"+t+"/image_load",function(y){var x=e(y);v.html(x)})})}function c(){if(e("#article_results_container").length>0){var v=e.getUrlVar("q");var s="";if(v){s="/articles?q="+v+"&catalog_select=all"}else{var u=e.getUrlVar("author")||"";var x=e.getUrlVar("journal")||"";var w=e.getUrlVar("title")||"";var t=e.getUrlVar("keyword")||"";s="/articles?search_field=advanced&author="+u+"&journal="+x+"&title="+w+"&keyword="+t+"&catalog_select=all"}e("#article_results_container").load(s,function(){e("#article_results_container").css("background","#FFF")})}}function g(){if(e("#folder_article_container").length>0){load_url="/folder/articles";e("#folder_article_container").load(load_url,function(){e("#folder_article_container").css("background","#FFF")})}}function j(){e(".addUserBookmarkForm .submitForm").click(function(t){t.preventDefault();var s=e(this);s.parent().html('This item is in <a href="/bookmarks">My Favorites</a>');s.parent().ajaxSubmit()})}function i(){e(".addFolderForm .submitForm").live("click",function(){var u={dataType:"json",beforeSubmit:t,success:s};var v=e(this).parent();v.ajaxSubmit(u);function t(y,x,w){v.children(".submitForm").addClass("saving-star");return true}function s(y,z,A,w){if(v.children("input[name='id']").length){var x=v.children("input[name='id']").val()}else{var x=v.children("input[name='article_id']").val()}v.closest(".folder_container").html('<a href="/folder/'+x+'" class="deleteFolder_link">Remove Star</a>');b(y.length)}return false});e(".deleteFolder_link, .deleteFolderArticle_link").live("click",function(){var t=e(this);var s=e(this).attr("href").substring(8);t.closest(".folder_container").html('<form action="/folder" class="addFolderForm" method="post" name="folder'+s+'"><input id="id" name="id" type="hidden" value="'+s+'"><a href="/folder" class="submitForm">Add Star</a><input class="hide" id="submitFolderForm_'+s+'" name="commit" type="submit" value="Add Star"></form>');e.post(t.attr("href"),{_method:"delete"});return false})}function b(s){if(s>=100){e(document).colorbox({html:'<div id="folder_full_notice">You may only save up to 100 items in your starred item list.  Please <a href="/folder">view and export</a> any items you wish to preserve then <a class="clear_all close-notice" href="/folder/clear">clear the list</a> to add more items.</div>',open:true,title:"Starred Item List Full",height:"40%",width:"40%"})}}e(".close-notice").live("click",function(){e(document).colorbox.close()});function k(){e(".action_list").hover(function(){e(".list_body").show()},function(){e(".list_body").hide()})}function a(){var t=new Array();var s=e(".deleteFolder_link");s.each(function(u){t[u]=e(this).attr("href").substring(8)});return t}function o(){var t=new Array();var s=e(".addFolderForm .submitForm");s.each(function(u){if(e(this).siblings("input[name='id']").length){t[u]=e(this).siblings("input[name='id']").val()}else{t[u]=e(this).siblings("input[name='article_id']").val()}});return t}function p(){e("a.select_all").click(function(){var u=o();if(e(u).length>0){var t=e(this);var s=e("body.articles-page").length?{"article_id[]":u}:{"id[]":u};e.ajax({url:"/folder",type:"POST",dataType:"json",data:s,beforeSend:function(w,v){e(".addFolderForm .submitForm").addClass("saving-star");t.addClass("link_disabled")},success:function(w,x,v){e(".addFolderForm .submitForm").each(function(z){var y=e(this).siblings("input[name='id']").val();e(this).closest(".folder_container").html('<a href="/folder/'+y+'" class="deleteFolder_link">Remove Star</a>')});b(w.length);t.removeClass("link_disabled")}})}return false})}function f(){e("a.clear_all").live("click",function(t){var s=a();if(e(s).length>0){e(this).addClass("link_disabled");e(".deleteFolder_link, .deleteFolderArticle_link").each(function(v){var w=e(this);var u=e(this).attr("href").substring(8);w.closest(".folder_container").html('<form action="/folder" class="addFolderForm" method="post" name="folder'+u+'"><input id="id" name="id" type="hidden" value="'+u+'"><a href="/folder" class="submitForm">Add Star</a><input class="hide" id="submitFolderForm_'+u+'" name="commit" type="submit" value="Add Star"></form>')});e("a.clear_all").removeClass("link_disabled");e.post("/folder/clear",{_method:"delete"})}return false})}function q(s){var s=e(s);s.find("a.next_page, a.prev_page, a.sort_change").click(function(){e("body").css("cursor","progress");s.find("ul.facet_extended_list").animate({opacity:0});s.load(this.href,function(){q(s);e("body").css("cursor","auto");var t=s.find("h1, h2, h3, h4, h5, h6").eq(0).remove();if(t.size()>0){s.dialog("option","title",t.text())}});return false})}function m(s){s=e(s);s.dialog("option","height",641);s.dialog("option","width",804);s.dialog("option","position",["center",75]);s.dialog("open").dialog("moveToTop");window.scrollTo(0,s.offset().top-70)}function d(){e("#PerPageSelector").change(function(){e("#PerPageContainer form").submit()});e("#SortSelector").change(function(){e("#SortFormContainer form").submit()})}function r(){e(".catalog-page .no-items-ask").click(function(){e(".libraryh3lp-container").show();return false})}function h(){e("a[data-counter]").click(function(t){var u=document.createElement("form");u.style.display="none";this.parentNode.appendChild(u);u.method="POST";u.action=e(this).attr("href");if(t.metaKey||t.ctrlKey){u.target="_blank"}var v=document.createElement("input");v.setAttribute("type","hidden");v.setAttribute("name","counter");v.setAttribute("value",e(this).attr("data-counter"));u.appendChild(v);var s=document.createElement("input");s.setAttribute("type","hidden");s.setAttribute("name","_method");s.setAttribute("value","put");u.appendChild(s);var s=document.createElement("input");s.setAttribute("type","hidden");s.setAttribute("name",e('meta[name="csrf-param"]').attr("content"));s.setAttribute("value",e('meta[name="csrf-token"]').attr("content"));u.appendChild(s);u.submit();return false})}function l(){n();j();i();k();p();f();c();g();d();r();h()}e.extend({getUrlVars:function(){var v=[],u;var s=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var t=0;t<s.length;t++){u=s[t].split("=");v.push(u[0]);v[u[0]]=u[1]}return v},getUrlVar:function(s){return e.getUrlVars()[s]}});l();e(document).ajaxSend(function(u,v,s){var t=e("meta[name='csrf-token']").attr("content");v.setRequestHeader("X-CSRF-Token",t)})});